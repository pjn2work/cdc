{% extends "base.html" %}
{% block title %}Ver Quota{% endblock %}
{% block page_header %}Quota {{ dp.id_year_month }}{% endblock %}
{% block content_in_div %}
    <div class="card">
        <div class="card-body">

            <div class="row mb-0">
                <div class="col-md-6">
                    <label class="form-label label-text align_center">Total pago</label>
                    <p class="form-control-plaintext data-text align_center">{{ dp.total_amount_paid|default(0, True) }} €</p>
                </div>
                <div class="col-md-6">
                    <label class="form-label label-text align_center">Associados já pagaram</label>
                    <p class="form-control-plaintext data-text align_center">{{ dp.total_members_paid|default(0, True) }}</p>
                </div>
            </div>
            <div class="row mb-0">
                <div class="col-md-6">
                    <label class="form-label label-text align_center">Total em atraso</label>
                    <p class="form-control-plaintext data-text align_center">{{ dp.total_amount_missing|default(0, True) }} €</p>
                </div>
                <div class="col-md-6">
                    <label class="form-label label-text align_center">Associados em atraso</label>
                    <p class="form-control-plaintext data-text align_center">{{ dp.total_members_missing|default(0, True) }}</p>
                </div>
            </div>

            <div class="row mb-0">
                <div class="col-md-12">
                    <h5>Associados com quota em atraso</h5>
                    <table class="table table-striped table-bordered">
                        <thead class="table-dark">
                            <tr>
                                <th class="align_right">ID</th>
                                <th class="align_left">Nome</th>
                                <th class="align_left">Contacto</th>
                                <th class="align_right">Valor</th>
                                <th class="align_left">Data de pagamento</th>
                                <th class="align_left">Última actualização</th>
                                <th class="align_center">Efectuar pagamento</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for mdp in dp.member_due_payment if mdp.is_member_active and not mdp.is_paid %}
                                <tr>
                                    <td class="align_right"><a href="../../members/{{ mdp.member_id }}/show">{{ mdp.member_id }}</a></td>
                                    <td class="align_left">{{ mdp.member.name }}</td>
                                    <td class="align_left">{{ mdp.member.tlf }}</td>
                                    <td class="align_right">{{ mdp.amount }} €</td>
                                    <td class="align_left">{{ mdp.pay_date|default("", True) }}</td>
                                    <td class="align_right">{{ mdp.pay_update_time }}</td>
                                    <td class="red align_center"><button onclick="pay_member_due({{ mdp.tid }})">Pagar</button></td>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="row mb-0">
                <div class="col-md-12">
                    <h5>Associados com quota paga</h5>
                    <table class="table table-striped table-bordered">
                        <thead class="table-light">
                            <tr>
                                <th class="align_right">ID</th>
                                <th class="align_left">Nome</th>
                                <th class="align_left">Contacto</th>
                                <th class="align_right">Valor</th>
                                <th class="align_left">Data de pagamento</th>
                                <th class="align_left">Última actualização</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for mdp in dp.member_due_payment if mdp.is_member_active and mdp.is_paid %}
                                <tr>
                                    <td class="align_right"><a href="../../members/{{ mdp.member_id }}/show">{{ mdp.member_id }}</a></td>
                                    <td class="align_left">{{ mdp.member.name }}</td>
                                    <td class="align_left">{{ mdp.member.tlf }}</td>
                                    <td class="align_right">{{ mdp.amount }} €</td>
                                    <td class="align_left">{{ mdp.pay_date|default("", True) }}</td>
                                    <td class="align_left">{{ mdp.pay_update_time }}</td>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>

        </div>
    </div>
{% endblock %}

{% block content_out_div %}
    {% include 'member_due_payment_form.html' %}
{% endblock %}